switch_role: leaf
sonic_interfaces:
   - name: Ethernet0
     description: To_Spine_1
     enabled: true
   - name: Ethernet1
     description: To_Spine_2
     enabled: true
   - name: Ethernet2
     description: To_Server_11
     enabled: true
   - name: Ethernet3
     description: To_Server_21
     enabled: true
   - name: Ethernet22
     description: To_MCLAG_peer
     enabled: true
   - name: Ethernet23
     description: To_MCLAG_peer
     enabled: true
   - name: Loopback0
     description: Loopback_underlay
     enabled: true
   - name: Loopback1
     description: Loopback_overlay
     enabled: true	

sonic_lag_interfaces:
   - name: Portchannel1
     members:
      interfaces:
        - member: Ethernet22
        - member: Ethernet23 
   - name: Portchannel100
     members:
       interfaces:
         - member: Ethernet2
   - name: Portchannel200
     members:
       interfaces:
         - member: Ethernet3

sonic_l3_interfaces:
   - name: "{{ loopback_underlay }}"
     ipv4:
       addresses: 
        - address: "{{ loopback0_ip }}"
   - name: "{{ loopback_overlay }}"
     ipv4:
       addresses:     
        - address: "{{ loopback1_ip }}"
   - name: "{{ 'Vlan' + vlan_mclag|string }}"
     ipv4:
       addresses:
        - address: "{{ vlan_mclag_ip }}"
   - name: "{{ To_spine_1 }}"
     ipv6:
       enabled: true      
   - name: "{{ To_spine_2 }}"
     ipv6:
       enabled: true

sonic_mclag:
  domain_id: 1
  peer_address: "{{peer_ip}}"
  source_address: "{{source_ip}}"
  peer_link: "{{PortChannel_mclag}}"
  keepalive: 1
  session_timeout: 3
  unique_ip:
    vlans:
      - vlan: "{{ 'Vlan' + vlan_mclag|string }}"
  members:
     portchannels:
       - lag: PortChannel100
       - lag: PortChannel200

sonic_route_maps_cli:
  - name: REDISTU
    permit: true
    seq: 10
    match_ip_prefix_list: UNDERLAY

sonic_prefix_list_cli:
  - name: UNDERLAY
    permit: true
    entries:
     - ip: 10.0.0.0/24
       condition: ge 32 le 32
       seq: 1
     - ip: 10.0.10.0/24
       condition: ge 32 le 32
       seq: 10

sonic_bgp:
   - bgp_as: "{{ bgp_asn }}"
     router_id: "{{ loopback0_ip.split('/')[0] }}"
     bestpath:
       as_path:
         multipath_relax: true
   - bgp_as: "{{ bgp_asn }}"
     vrf_name: Vrf1
   - bgp_as: "{{ bgp_asn }}"
     vrf_name: Vrf2

sonic_bgp_af:
    - bgp_as: "{{ bgp_asn }}"
      address_family:
        afis:
          - afi: l2vpn
            safi: evpn
            advertise_all_vni: true
          - afi: ipv4
            safi: unicast
            redistribute:
              - protocol: connected
                route_map: REDISTU
            max_path:
              ebgp: 4 
    - bgp_as: "{{ bgp_asn }}"
      vrf_name: Vrf1
      address_family:
        afis:
          - afi: l2vpn
            safi: evpn
            advertise_prefix:
              - afi: ipv4
                safi: unicast
          - afi: ipv4
            safi: unicast
            redistribute:
              - protocol: connected
            max_path:
              ebgp: 4
    - bgp_as: "{{ bgp_asn }}"
      vrf_name: Vrf2
      address_family:
        afis:
          - afi: l2vpn
            safi: evpn
            advertise_prefix:
              - afi: ipv4
                safi: unicast
          - afi: ipv4
            safi: unicast
            redistribute:
              - protocol: connected
            max_path:
              ebgp: 4

sonic_bgp_neighbors:
    - bgp_as: "{{ bgp_asn }}"
      peer_group:
        - name: SPINE
          remote_as:
            peer_type: external
          advertisement_interval: 5
          timers:
            keepalive: 3
            holdtime: 9
          bfd: true
          capability:
            extended_nexthop: true
          address_family:
            afis:
              - afi: l2vpn
                safi: evpn
                activate: true
              - afi: ipv4
                safi: unicast
                activate: true
                allowas_in:
                  value: 2            
      neighbors:
        - neighbor: "{{ To_spine_1 }}"
          peer_group: SPINE
        - neighbor: "{{ To_spine_2 }}"
          peer_group: SPINE

sonic_l2_vni_vlans_list:
  - vlan_id: 100
  - vlan_id: 150
  - vlan_id: 200

sonic_l3_vni_vlans_list:
  - vlan_id: 199

sonic_vlans_prefix_list:
  - vlan_id: 100
    prefix: 192.168.100.0/24 
  - vlan_id: 150
    prefix: 192.168.150.0/24
  - vlan_id: 199
  - vlan_id: 200
    prefix: 192.168.200.0/24

sonic_vlans_interfaces:
  - name: Portchannel1
    trunk:
      allowed_vlans:
        - vlan: 4094
        - vlan: 199
  - name: Portchannel100
    access:
      vlan: "{{vlan_client_1}}"
  - name: Portchannel200
    access:
      vlan: "{{vlan_client_2}}"

sonic_vxlan_conf:
  - name: "{{ vtep_name }}"
    source_ip: "{{ loopback1_ip[:-3] }}"
    evpn_nvo: nvo1 
    vlan_map:
      - vni: 100
        vlan: 100
      - vni: 150
        vlan: 150
      - vni: 199
        vlan: 199
      - vni: 200
        vlan: 200
    vrf_map:
      - vni: 199
        vrf: Vrf1 

sonic_anycast_mac_address: 00:00:00:00:91:87 

sonic_vrfs:
  - name: Vrf1
    members:
      interfaces:
        - name: Vlan100 
        - name: Vlan150
        - name: Vlan199
  - name: Vrf2 
    members:
      interfaces:
        - name: Vlan200

devices:
  leaf1:
    priority: primary
    l3interfaces:
      Loopback0: 
        name: Loopback0 
        ipv4: 10.0.0.1/32
        description: Underlay Loopback
      Vlan4094:
        ipv4: 10.10.0.0/31 
  leaf2:
    priority: secondary
    l3interfaces:
      Loopback0:
        name: Loopback0
        ipv4: 10.0.0.2/32
        description: Underlay Loopback
      Vlan4094:
        ipv4: 10.10.0.1/31
  leaf3:
    priority: primary
    l3interfaces:
      Loopback0:
        name: Loopback0
        ipv4: 10.0.0.3/32
        description: Underlay Loopback
      Vlan4094:
        ipv4: 10.10.0.2/31
  leaf4:
    priority: secondary
    l3interfaces:
      Loopback0:
        name: Loopback0 
        ipv4: 10.0.0.4/32
        description: Underlay Loopback
      Vlan4094:
        ipv4: 10.10.0.3/31

